<!DOCTYPE html>
<html lang="en">
<head>
    <title>Bootstrap Example</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

    <link rel="stylesheet" type="text/css" href="newStyles.css">


    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <!--<title>Wikidata Visualization Engine</title>-->
    <!--<link rel="stylesheet" type="text/css" href="styles.css">-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>

<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.3.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.2.3/firebase-database.js"></script>
<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="//d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-hierarchy.v1.min.js"></script>
<script src="AmchartGraph/core.js"></script>
<script src="AmchartGraph/charts.js"></script>
<script src="AmchartGraph/themes/animated.js"></script>
<script src="AmchartGraph/plugins/forceDirected.js"></script>
<script>
    // Your web app's Firebase configuration
    var firebaseConfig = {
        apiKey: "AIzaSyCaxMo8rfeEkDWTlAXZy_-rNcTqxpFLh_s",
        authDomain: "wikidata-visualization.firebaseapp.com",
        databaseURL: "https://wikidata-visualization.firebaseio.com",
        projectId: "wikidata-visualization",
        storageBucket: "wikidata-visualization.appspot.com",
        messagingSenderId: "44744854813",
        appId: "1:44744854813:web:af01dc81d43b150c6565f4",
        measurementId: "G-JZDLW4MY64"
    };
    firebase.initializeApp(firebaseConfig);
</script>
<script src="./newCode.js"></script>


<div class="container-fluid">
    <div class="row content">
        <div class="col-sm-3 sidenav" id="mainPage">
            <div class="container-fluid">
                <div class="row-fluid" id="header">
                    <!--<h1>Wikidata<br>Visualization Engine</h1>-->
                    <h1>Wikidata Visualization Engine</h1>
                </div>
            </div>


            <!--search entity div-->
            <div class="container-fluid" id="searchEntityDiv">
                <div class="col">
                    <h2>Music Entity</h2>
                    <label>
                        <h4>Artists Search</h4>
                    </label>
                    <div class="input-group">
                        <input class="form-control" id="searchEntity" list="entities" name="entity" placeholder="Type to search..." >
                        <datalist id="entities">

                        </datalist>
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-primary" id="entityBtn" onclick = "chooseEntity()">Submit</button>
                        </span>
                        <!--<input id="entityBtn" type="submit" onclick = "chooseEntity()">-->
                    </div>

                    <!--<div class="row" id="checkDiv">-->
                        <!--<div class="panel-footer" >-->
                            <!--&lt;!&ndash;<div id="checkDiv">&ndash;&gt;-->
                            <!--&lt;!&ndash;<h4>Are You Interested in</h4>&ndash;&gt;-->
                            <!--&lt;!&ndash;<input id="work" type="submit" value="work content" >&ndash;&gt;-->
                            <!--&lt;!&ndash;<input id="personal" type="submit" value="personal content" >&ndash;&gt;-->
                            <!--&lt;!&ndash;</div>&ndash;&gt;-->
                            <!--<h4>Are You Interested in:</h4>-->
                            <!--<div class="row">-->
                                <!--<div class="col-xs-6">-->
                                    <!--<button id="work" type="button" class="btn btn-primary">work content</button>-->
                                    <!--&lt;!&ndash;<input type="radio" name="choice" value="band">band<br>&ndash;&gt;-->
                                <!--</div>-->
                                <!--<div class="col-xs-6">-->
                                    <!--<button id="personal" type="button" class="btn btn-primary">personal content</button>-->
                                    <!--&lt;!&ndash;<input type="radio" name="choice" value="artist">artist&ndash;&gt;-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                        <!--<div class="panel-footer" id="radioDiv2">-->
                            <!--&lt;!&ndash;<form id="radioDiv2">&ndash;&gt;-->
                            <!--&lt;!&ndash;<input type="radio" name="albumsOrSongs" value="albums">albums<br>&ndash;&gt;-->
                            <!--&lt;!&ndash;<input type="radio" name="albumsOrSongs" value="songs">songs&ndash;&gt;-->
                            <!--&lt;!&ndash;</form>&ndash;&gt;-->
                            <!--<h4>Are You Interested in:</h4>-->
                            <!--<div class="row">-->
                                <!--<div class="col-xs-6">-->
                                    <!--<button type="button" class="btn btn-primary">Click For Albums</button>-->
                                <!--</div>-->
                                <!--<div class="col-xs-6">-->
                                    <!--<button type="button" class="btn btn-primary">Click For Songs</button>-->
                                <!--</div>-->
                            <!--</div>-->

                        <!--</div>-->
                    <!--</div>-->

                </div>
            </div>
        </div>

        <!--graph and legend-->
        <div  class="col-sm-9" >
            <div id="chartdiv"></div>
        </div>

        <div id="loading" style="display: none;">
            <img id="loading-image" src="images/ajax-loader.gif" alt="Loading...">
        </div>
    </div>


</div>
<footer class="footer navbar-fixed-bottom">
    <p>2020 Â© All Rights Reserved. </p>
</footer>



<!--<script src="./chooseSubject.html"></script>-->

<script src="./amchartgraphbuid.js"></script>
<script src="./sparqlQuery.js"></script>
<script src="./csvtoarray.js"></script>
<script src="./csvtoarray2.js"></script>
<script src="./sparklqueryForAlbums.js"></script>
<script src="./sparqlqueryForSongs.js"></script>
<script src="./SparqlQueryAlbumInfo.js"></script>
<script src="./SparqlQuerySongsInfo.js"></script>
<script src="./SparqlQueryAlbumTracks.js"></script>

<script>
    var loading = document.getElementById("loading");

    function showloading() {loading.style.display = "block";}
    function hideLoading() {loading.style.display = "none";}


    var searchEntityDiv = document.getElementById("searchEntityDiv");
    var searchEntity = document.getElementById("searchEntity");
    var entitiesDataList = document.getElementById("entities");
    var entityBtn = document.getElementById("entityBtn");
    // var checkDiv = document.getElementById("checkDiv");
    // var workInput = document.getElementById("work");
    // var personalInput = document.getElementById("personal");

    // searchEntityDiv.style.display = "none";
    // searchEntity.style.display = "none";
    // entitiesDataList.style.display = "none";
    // entityBtn.style.display = "none";
    // checkDiv.style.display = "none";
    // workInput.style.display = "none";
    // personalInput.style.display = "none";

    console.log("artists");
    bOrA = "artists";
    var artistsList=[];
    showloading();
    //retrieve list all artists in Wikidata
    $.getJSON('datafiles/artists.json', function (jd) {
        for (var i = 0; i < jd.results.bindings.length; i++) {
            var parts = jd.results.bindings[i].person.value.split("/");
            var result = parts[parts.length - 1]; // Or parts.pop();
            artistsList[i] = jd.results.bindings[i].personLabel.value + "(" + result + ")";
        }
        artistsList.forEach(function (item) {
            var option = document.createElement('option');
            option.value = item;
            entitiesDataList.appendChild(option);
        });
    }).then(()=>{
        hideLoading();
        searchEntity.value = "";

        entityBtn.onclick = ()=>{
            //if input is invalid
            if(artistsList.indexOf(searchEntity.value) === -1){
                searchEntity.value = "";
                //
                //alert or logout a message => "invalid input try again"

                ////////////////////////////
            }
            else{//artist is in DB
                //get entity's personal data , list of songs and list of albums
                console.log(searchEntity.value);

                req(searchEntity.value,bOrA);
                songsreq(searchEntity.value,bOrA);
                albumreq(searchEntity.value,bOrA);

                showloading();
                setTimeout(function(){
                    //redirect to workOrPersonalContent.html and send label and QID
                    var labelAndQid = searchEntity.value.slice(0, -1).split('(');
                    var dirLocation = location.href;
                    dirLocation = dirLocation.split("/").slice(0, -1).join("/").concat('/workOrPersonalContent.html');
                    window.location.href = dirLocation + '?label=' + labelAndQid[0] +'&qid='+ labelAndQid[1]+'&bOrA='+ bOrA; // go to workOrPersonalContent  page                    hideLoading();
                },10000);

            }
        };

    });
    ////////////////////////////////////////



</script>


</body>
</html>